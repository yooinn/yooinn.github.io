<!DOCTYPE html>
<html>
  <head>
      
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Jiank</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="description" content="æ¸©æ•…è€ŒçŸ¥æ–°"/>
<meta name="keywords" content="æ¸©æ•…è€ŒçŸ¥æ–°"/>

<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
<link rel="shortcut icon" href="https://yooinn.github.io//favicon.ico">

<link rel="stylesheet" href="https://yooinn.github.io//styles/main.css">

<!-- Modernizr JS -->
<script src="https://yooinn.github.io/media/scripts/vendors/modernizr-2.6.2.min.js"></script>
<!-- FOR IE9 below -->
<!--[if lt IE 9]>
<scripts src="https://yooinn.github.io//media/scripts/_vendors/respond.min.js"></scripts>
<![endif]-->

<!-- Comment -->

    
        <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
    

    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/tomorrow-night.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
<link crossorigin="anonymous" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" href="https://lib.baomitu.com/font-awesome/5.8.1/css/all.min.css" rel="stylesheet">

  </head>
  <body>
  
<div id="fh5co-offcanvas">
    <a href="#!" class="fh5co-close-offcanvas js-fh5co-close-offcanvas">
        <span><i class="icon-cross3"></i> <span>Close</span></span>
    </a>
    <div class="fh5co-bio">
        <figure>
            <img src="https://yooinn.github.io//media/images/avatar.png" alt="Jiank" class="img-responsive">
        </figure>
        <h3 class="heading">ABOUT ME</h3>
        <h2>Jiank</h2>
        <p>æ¸©æ•…è€ŒçŸ¥æ–°</p>
        <ul class="fh5co-social">
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
        </ul>
    </div>

    <div class="fh5co-menu">
        <div class="fh5co-box">
            <h3 class="heading">æœç´¢</h3>
            <form action="#">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="è¾“å…¥å…³é”®å­—">
                </div>
            </form>
        </div>
        <div class="fh5co-box">
            <h3 class="heading">æ ‡ç­¾</h3>
            <ul>
                
                    <li><a href="https://yooinn.github.io//tag/tXH4POF09">python</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/QRAqbdG_m">django</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/jj-MVXJyc">mongodb</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/FuqRNjlSWx">çˆ¬è™«</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/LIFaQWPrF">Centos</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/ewoty_xe6">CSRF</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/Mz5dw6SaJF">æ”»å‡»</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/mgBwHqvScq">ä»£ç†</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/wV8K1iN-L">sublime</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/FTcnjIO1M9">å¼€å‘ç¯å¢ƒ</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/slsqa3JFOO">åŠ å¯†</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/IL7UdZM90j">è§£å¯†</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/HOyveGXQl">redis</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/b9SNjXwUQ6">ç¼“å­˜</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/zE5M8ZF1G">ç®—æ³•</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/8ds-G3FOk2">é˜Ÿåˆ— æ¶ˆæ¯ çº¿ç¨‹</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/QakZrWwK7">mysql</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/gridea">Gridea</a></li>
                
            </ul>
        </div>
    </div>
</div>

<header id="fh5co-header">
    <div class="container-fluid">
        <div class="row">
            <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
            <ul class="fh5co-social">
                
                    <li>
                        <a href="/"
                         >
                            é¦–é¡µ
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives"
                         >
                            å½’æ¡£
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags"
                         >
                            æ ‡ç­¾
                        </a>
                    </li>
                
                    <li>
                        <a href="/post/about"
                         >
                            å…³äº
                        </a>
                    </li>
                
            </ul>
            <div class="col-lg-12 col-md-12 text-center">
                <h1 id="fh5co-logo">
                    <a href="https://yooinn.github.io/">Jiank</a>
                </h1>
            </div>
        </div>
    </div>
</header>


<!--  <a href="#" class="fh5co-post-prev"><span>ğŸ‘ˆ Prev</span></a>-->
<!--  <a href="#" class="fh5co-post-next"><span>Next ğŸ‘‰</span></a>-->

  <div class="container-fluid">
      <div class="row fh5co-post-entry single-entry">
          <article class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2 col-xs-12 col-xs-offset-0">
              <figure class="animate-box">
                  
              </figure>
              <span class="fh5co-meta animate-box">
                  
                      <div class="tag-container">
                          
                              <a href="https://yooinn.github.io//tag/QRAqbdG_m" class="tag">django, </a>
                          
                      </div>
                  
              </span>
              <h2 class="fh5co-article-title animate-box">Djangoæ¡†æ¶é™æ€æ–‡ä»¶ä½¿ç”¨/ä¸­é—´ä»¶/ç¦ç”¨ipåŠŸèƒ½å®ä¾‹è¯¦è§£</h2>
              <span class="fh5co-meta fh5co-date animate-box">2019-09-20</span>

              <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0 col-xs-12 col-xs-offset-0 text-left content-article">
                  <div class="row">
                      <div class="col-md-12 animate-box post-content">
                          <p> <p>é™æ€æ–‡ä»¶</p>
<p>ä¸€ã€é™æ€æ–‡ä»¶çš„ä½¿ç”¨</p>
<p>é™æ€æ–‡ä»¶ï¼šç½‘é¡µä¸­ä½¿ç”¨çš„cssï¼Œjsï¼Œå›¾ç‰‡</p>
<p>é™æ€æ–‡ä»¶çš„ä½¿ç”¨ï¼š</p>
<p>åœ¨é¡¹ç›®ä¸‹åˆ›å»ºé™æ€ç›®å½•ï¼Œæ¯”å¦‚ï¼šstaticï¼Œå¯¼å…¥é™æ€æ–‡ä»¶ï¼ˆHTMLã€CSSã€jsï¼‰</p>
<p>åœ¨setting.pyä¸­é…ç½®é™æ€ç›®å½•</p>
<pre><code>
# é€šè¿‡æ­¤urlæ¥å¼•ç”¨é™æ€æ–‡ä»¶ï¼Œå¯ä»¥éšè—æœåŠ¡å™¨çš„æ–‡ä»¶çš„å®é™…ä¿å­˜ç›®å½•
STATIC_URL = '/abc/'
# æŒ‡å®šé™æ€æ–‡ä»¶æ‰€åœ¨çš„ç‰©ç†ç›®å½•
STATICFILES_DIRS = [os.path.join(BASE_DIR, 'static')]
</code></pre>
<p>é€šè¿‡setting.pyä¸­çš„STATIC_URLçš„å€¼æ¥å¼•ç”¨é™æ€æ–‡ä»¶ï¼Œå¥½å¤„ï¼šå¯ä»¥éšè—æœåŠ¡å™¨çš„æ–‡ä»¶çš„å®é™…ä¿å­˜ç›®å½•ã€‚æ¯”å¦‚ï¼š</p>
<pre><code>&lt;img src=&quot;/abc/image/mm.jpg&quot; /&gt;
&lt;script src=&quot;/abc/js/jquery-1.12.4.min.js&quot;&gt;&lt;/script&gt;
</code></pre>
<p>äºŒã€ä½¿ç”¨staticæ ‡ç­¾åŠ¨æ€å¼•ç”¨</p>
<p>ä¸Šè¿°å†™æ³•æ˜¯ç¡¬ç¼–ç ï¼Œå­˜åœ¨ç»´æŠ¤é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨staticæ ‡ç­¾åŠ¨æ€å¼•ç”¨</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
{% load staticfiles %}
&lt;head&gt;
...
&lt;/head&gt;
&lt;body&gt;
åŠ¨æ€å¼•ç”¨ï¼š&lt;br/&gt;
&lt;img src=&quot;{% static 'image/mm.jpg' %}&quot;/&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>ä¸­é—´ä»¶</p>
<p>MIDDLEWARE: ä¸­é—´ä»¶</p>
<p>ä¸€ã€æ¡ˆä¾‹ï¼š ç¦æ­¢æŒ‡å®šipåœ°å€çš„è®¿é—®</p>
<p>ä½¿ç”¨requestå¯¹è±¡çš„METAå±æ€§ï¼Œå¯ä»¥è·å–ç”¨æˆ·è®¿é—®çš„ipåœ°å€ï¼š</p>
<p>request.META.get('REMOTE_ADDR')</p>
<p>äºŒã€ä¸­é—´ä»¶</p>
<p>ä¸­é—´ä»¶ï¼š djangoæ¡†æ¶é¢„ç•™çš„æ¥å£ï¼Œå¯ä»¥æ§åˆ¶è¯·æ±‚å’Œå“åº”çš„è¿‡ç¨‹ã€‚Djangoåœ¨ä¸­é—´ä»¶ä¸­é¢„ç½®äº†6ä¸ªæ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ä¼šåœ¨ä¸åŒçš„é˜¶æ®µæ‰§è¡Œï¼Œå¯¹è¾“å…¥æˆ–è¾“å‡ºè¿›è¡Œå¹²é¢„ã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://files.jb51.net/file_images/article/201907/2019722114704117.png?2019622114834" alt=""></figure>
<p>åˆå§‹åŒ–ï¼šæ— éœ€ä»»ä½•å‚æ•°ï¼ŒæœåŠ¡å™¨å“åº”ç¬¬ä¸€ä¸ªè¯·æ±‚çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼š</p>
<p>def <strong>init</strong>():<br>
pass</p>
<p>å¤„ç†è¯·æ±‚å‰(urlåŒ¹é…å‰)è°ƒç”¨ï¼š è¿”å›Noneæˆ–HttpResponseå¯¹è±¡</p>
<p>def process_request(self, request):<br>
pass</p>
<p>urlåŒ¹é…åè§†å›¾å‡½æ•°å¤„ç†å‰è°ƒç”¨ï¼š è¿”å›Noneæˆ–HttpResponseå¯¹è±¡</p>
<p>def process_view(self, request, view_func, view_args, view_kwargs):<br>
pass</p>
<p>è§†å›¾å‡½æ•°å‡ºå¼‚å¸¸æ—¶è°ƒç”¨ï¼šè¿”å›ä¸€ä¸ªHttpResponseå¯¹è±¡</p>
<p>def process_exception(self, request, exception):<br>
return response</p>
<p>è§†å›¾å‡½æ•°å¤„ç†åï¼Œæ¨¡æ¿å“åº”å¤„ç†å‰è°ƒç”¨ï¼š è¿”å›å®ç°äº†renderæ–¹æ³•çš„å“åº”å¯¹è±¡</p>
<p>def process_template_response(self, request, response):<br>
pass</p>
<p>è§†å›¾å‡½æ•°è¿”å›TemplateReponseæ—¶æ‰ä¼šè°ƒç”¨ï¼Œè¿”å›HttpResponseå¯¹è±¡ä¸ä¼šè°ƒç”¨</p>
<p>è§†å›¾å‡½æ•°å¤„ç†åï¼Œè¿”å›å†…å®¹ç»™æµè§ˆå™¨å‰è°ƒç”¨ï¼šè¿”å›HttpResponseå¯¹è±¡</p>
<p>def process_response(self, request, response):<br>
return response</p>
<p>ç¦ç”¨ipåŠŸèƒ½</p>
<p>åœ¨MyMiddlewareçš„process_viewæ–¹æ³•ä¸­ï¼Œæ–°å¢ä»£ç å¦‚ä¸‹ï¼š</p>
<p>class MyMiddleware(object):<br>
...<br>
exclude_ips = ['127.0.0.1']<br>
def process_view(self, request, view_func, view_args, view_kwargs):<br>
print('--process_view--')<br>
# ç¦ç”¨ipï¼Œä»¥ä¸‹ä»£ç ä¹Ÿå¯ä»¥æ·»åŠ åˆ°process_requestæ–¹æ³•<br>
ip = request.META.get('REMOTE_ADDR')<br>
if ip in exclude_ips:<br>
return HttpResponse('ç¦æ­¢è®¿é—®')</p>
<p>å¼‚å¸¸å¤„ç†</p>
<p>å¼‚å¸¸å¤„ç†ï¼š è§†å›¾å‡½æ•°æ‰§è¡Œå‡ºé”™ä¹‹åï¼Œä¼šè°ƒç”¨ä¸­é—´ä»¶çš„process_exceptionæ–¹æ³•ï¼Œå¯ä»¥åœ¨è¯¥æ–¹æ³•ä¸­æ‰§è¡Œå¼‚å¸¸æ“ä½œã€‚</p>
<p>åœ¨indexè§†å›¾å‡½æ•°ä¸­ï¼Œæ·»åŠ æ‰§è¡Œå‡ºé”™ä»£ç ï¼š</p>
<p>def index(request):<br>
&quot;&quot;&quot;è¿›å…¥é¦–é¡µ&quot;&quot;&quot;<br>
print('=<mark><mark>index</mark></mark>')</p>
<h1 id="æ·»åŠ å‡ºé”™ä»£ç ">æ·»åŠ å‡ºé”™ä»£ç </h1>
<p>aa = None<br>
print('aa='+ aa)<br>
return render(request, 'app01/index.html')</p>
<p>åœ¨å‰é¢ç¼–å†™çš„MyMiddlewareä¸­ï¼š æ·»åŠ å¤„ç†å¼‚å¸¸çš„ä¸­é—´ä»¶æ–¹æ³•ï¼Œå¹¶æ³¨é‡Šå‰é¢çš„æ‹¦æˆªipçš„æ‹¦æˆªï¼š</p>
<h1 id="middlewarepy">middleware.py</h1>
<p>class MyMiddleware(object):<br>
...<br>
def process_view(self, request, view_func, view_args, view_kwargs):<br>
print('-------process_view')<br>
# # ç¦æ­¢ipè®¿é—®<br>
# ip = request.META.get('REMOTE_ADDR')<br>
# if ip in exclude_ips:<br>
#   return HttpResponse('ç¦æ­¢è®¿é—®')<br>
def process_exception(self, request, exception):<br>
print('-----process_exception')</p>
<p>è®¿é—®é¦–é¡µï¼ŒæŸ¥çœ‹æœåŠ¡å™¨ï¼Œå‘ç°ï¼šå¤„ç†å¼‚å¸¸çš„ä¸­é—´ä»¶æ–¹æ³•process_exceptionæ‰§è¡Œäº†</p>
<p>å¤„ç†å‡ºé”™ï¼š åœ¨process_exceptionæ–¹æ³•ä¸­è¿”å›HttpResponseå¯¹è±¡å°±å¯ä»¥äº†ï¼š</p>
<h1 id="middlewarepy-2">middleware.py</h1>
<p>class MyMiddleware(object):<br>
...<br>
def process_exception(self, request, exception):<br>
print('-----process_exception')<br>
return HttpResponse('è¿è¡Œå‡ºé”™äº†ï¼š%s' % exception)</p>
<p>å¸Œæœ›æœ¬æ–‡æ‰€è¿°å¯¹å¤§å®¶åŸºäºDjangoæ¡†æ¶çš„Pythonç¨‹åºè®¾è®¡æœ‰æ‰€å¸®åŠ©ã€‚</p>
 </p>
                      </div>
                  </div>

                  <div class="row">
                      <div class="col-md-12 animate-box">
                          
                              <div class="next-post">
                                  <div class="next">ä¸‹ä¸€ç¯‡</div>
                                  <a href="https://yooinn.github.io//post/django-zhong-jian-jian-lan-jie-wei-deng-lu-url-shi-li-xiang-jie">
                                      <h3 class="post-title">
                                          Djangoä¸­é—´ä»¶æ‹¦æˆªæœªç™»å½•urlå®ä¾‹è¯¦è§£
                                      </h3>
                                  </a>
                              </div>
                          
                      </div>
                  </div>

                  <div class="row">
                      <div class="col-md-12 animate-box">
                          
                              
                                  <div id="gitalk-container"></div>
                              

                              
                          
                      </div>
                  </div>
              </div>

          </article>
      </div>
  </div>

    
<footer id="fh5co-footer">
  <p>Powered by <a href="https://yooinn.github.io/" target="_blank">Jiank</a></p>
</footer>


    
<!-- jQuery -->
<script src="https://yooinn.github.io//media/scripts/vendors/jquery.min.js"></script>
<!-- jQuery Easing -->
<script src="https://yooinn.github.io//media/scripts/vendors/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="https://yooinn.github.io//media/scripts/vendors/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="https://yooinn.github.io//media/scripts/vendors/jquery.waypoints.min.js"></script>
<!-- Main JS -->
<script src="https://yooinn.github.io//media/scripts/vendors/main.js"></script>
<!-- Md5 Min JS -->
<script src="https://yooinn.github.io//media/scripts/vendors/md5.min.js"></script>

<script type="application/javascript">
    hljs.initHighlightingOnLoad();
</script>



    
        <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
        <script>

            var gitalk = new Gitalk({
                clientID: '18da3e757583aa6301c0',
                clientSecret: '49cea6508bf61d7606bce51766288ea312bd7456',
                repo: 'yooinn.github.io',
                owner: 'yooinn',
                admin: ['yooinn'],
                id: md5(location.pathname),      // Ensure uniqueness and length less than 50
                distractionFreeMode: false  // Facebook-like distraction free mode
            })

            gitalk.render('gitalk-container')

        </script>
    

    




  </body>
</html>
