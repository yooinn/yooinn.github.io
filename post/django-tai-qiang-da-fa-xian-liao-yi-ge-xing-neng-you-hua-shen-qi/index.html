<!DOCTYPE html>
<html>
  <head>
      
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Jiank</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="description" content="æ¸©æ•…è€ŒçŸ¥æ–°"/>
<meta name="keywords" content="æ¸©æ•…è€ŒçŸ¥æ–°"/>

<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
<link rel="shortcut icon" href="https://yooinn.github.io//favicon.ico">

<link rel="stylesheet" href="https://yooinn.github.io//styles/main.css">

<!-- Modernizr JS -->
<script src="https://yooinn.github.io/media/scripts/vendors/modernizr-2.6.2.min.js"></script>
<!-- FOR IE9 below -->
<!--[if lt IE 9]>
<scripts src="https://yooinn.github.io//media/scripts/_vendors/respond.min.js"></scripts>
<![endif]-->

<!-- Comment -->

    
        <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
    

    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/tomorrow-night.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
<link crossorigin="anonymous" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" href="https://lib.baomitu.com/font-awesome/5.8.1/css/all.min.css" rel="stylesheet">

  </head>
  <body>
  
<div id="fh5co-offcanvas">
    <a href="#!" class="fh5co-close-offcanvas js-fh5co-close-offcanvas">
        <span><i class="icon-cross3"></i> <span>Close</span></span>
    </a>
    <div class="fh5co-bio">
        <figure>
            <img src="https://yooinn.github.io//media/images/avatar.png" alt="Jiank" class="img-responsive">
        </figure>
        <h3 class="heading">ABOUT ME</h3>
        <h2>Jiank</h2>
        <p>æ¸©æ•…è€ŒçŸ¥æ–°</p>
        <ul class="fh5co-social">
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
        </ul>
    </div>

    <div class="fh5co-menu">
        <div class="fh5co-box">
            <h3 class="heading">æœç´¢</h3>
            <form action="#">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="è¾“å…¥å…³é”®å­—">
                </div>
            </form>
        </div>
        <div class="fh5co-box">
            <h3 class="heading">æ ‡ç­¾</h3>
            <ul>
                
                    <li><a href="https://yooinn.github.io//tag/tXH4POF09">python</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/QRAqbdG_m">django</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/jj-MVXJyc">mongodb</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/FuqRNjlSWx">çˆ¬è™«</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/LIFaQWPrF">Centos</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/ewoty_xe6">CSRF</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/Mz5dw6SaJF">æ”»å‡»</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/mgBwHqvScq">ä»£ç†</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/wV8K1iN-L">sublime</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/FTcnjIO1M9">å¼€å‘ç¯å¢ƒ</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/slsqa3JFOO">åŠ å¯†</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/IL7UdZM90j">è§£å¯†</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/HOyveGXQl">redis</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/b9SNjXwUQ6">ç¼“å­˜</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/zE5M8ZF1G">ç®—æ³•</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/8ds-G3FOk2">é˜Ÿåˆ— æ¶ˆæ¯ çº¿ç¨‹</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/QakZrWwK7">mysql</a></li>
                
                    <li><a href="https://yooinn.github.io//tag/gridea">Gridea</a></li>
                
            </ul>
        </div>
    </div>
</div>

<header id="fh5co-header">
    <div class="container-fluid">
        <div class="row">
            <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
            <ul class="fh5co-social">
                
                    <li>
                        <a href="/"
                         >
                            é¦–é¡µ
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives"
                         >
                            å½’æ¡£
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags"
                         >
                            æ ‡ç­¾
                        </a>
                    </li>
                
                    <li>
                        <a href="/post/about"
                         >
                            å…³äº
                        </a>
                    </li>
                
            </ul>
            <div class="col-lg-12 col-md-12 text-center">
                <h1 id="fh5co-logo">
                    <a href="https://yooinn.github.io/">Jiank</a>
                </h1>
            </div>
        </div>
    </div>
</header>


<!--  <a href="#" class="fh5co-post-prev"><span>ğŸ‘ˆ Prev</span></a>-->
<!--  <a href="#" class="fh5co-post-next"><span>Next ğŸ‘‰</span></a>-->

  <div class="container-fluid">
      <div class="row fh5co-post-entry single-entry">
          <article class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2 col-xs-12 col-xs-offset-0">
              <figure class="animate-box">
                  
              </figure>
              <span class="fh5co-meta animate-box">
                  
                      <div class="tag-container">
                          
                              <a href="https://yooinn.github.io//tag/QRAqbdG_m" class="tag">django, </a>
                          
                      </div>
                  
              </span>
              <h2 class="fh5co-article-title animate-box">Djangoå¤ªå¼ºå¤§ï¼Œå‘ç°äº†ä¸€ä¸ªæ€§èƒ½ä¼˜åŒ–ç¥å™¨</h2>
              <span class="fh5co-meta fh5co-date animate-box">2019-11-21</span>

              <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0 col-xs-12 col-xs-offset-0 text-left content-article">
                  <div class="row">
                      <div class="col-md-12 animate-box post-content">
                          <p> <p>Djangoå¾ˆå¼ºå¤§ï¼Œå‘ç°äº†ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„åŠŸèƒ½<br>
é—®é¢˜èƒŒæ™¯ï¼š<br>
ç™¾ä¸‡çº§æ•°æ®ï¼Œåšå‰ç«¯é¡µé¢åˆ†é¡µï¼Œå‡ºç°æ‰“å¼€ç½‘é¡µç¬¬ä¸€æ¬¡æ‰“å¼€å¾ˆæ…¢ï¼ŒåŸºæœ¬è¦å¥½å‡ ç§’ï¼Œç¬¬äºŒæ¬¡æ‰“å¼€é€Ÿåº¦è¾ƒå¿«ï¼ŒåŸºæœ¬æ˜¯ç§’å¼€</p>
<p>ä»£ç å†™äº†3ä¸ªæŸ¥è¯¢è¯­å¥ï¼š<br>
1ã€æŸ¥è¯¢è¡¨ä¸­æ•°æ®ä¸ªæ•°ï¼Œç”¨äº†countï¼ˆï¼‰æ–¹æ³•<br>
2ã€æ ¹æ®[start:end]è¿›è¡Œåˆ‡ç‰‡ï¼Œå®ç°çš„ä¸ºlimitæŸ¥è¯¢ï¼Œæ¯æ¬¡è¿”å›15æ¡æ•°æ®<br>
3ã€éå†range(start,end),é€šè¿‡åˆ—è¡¨æ¨å¯¼å¼ï¼Œæ ¹æ®æƒŸä¸€ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢ï¼Œä¹Ÿæ˜¯15æ¡æ•°æ®</p>
<pre><code>counts = ArticleMmOther.objects.all().count()
#arts = ArticleMmOther.objects.values(&quot;id&quot;,&quot;title&quot;)[start:end]
arts = [ArticleMmOther.objects.values(&quot;id&quot;,&quot;title&quot;).get(id=i) for i in range(start, end)]
paginator = Paginator(range(counts), 15)
</code></pre>
<p>æˆ‘è¦æ¢ç´¢2ä¸ªé—®é¢˜ï¼š<br>
1ã€è¿™3æ¡æŸ¥è¯¢è¯­å¥ï¼Œä¸­é—´æœ‰ä¸€ä¸ªæŸ¥è¯¢æ¯”è¾ƒè€—æ—¶ï¼Œæˆ‘çš„å‰ç«¯é¡µé¢åœ¨è®¿é—®é¡µé¢çš„æ—¶å€™ï¼Œè¦è¿‡å¥½å‡ ç§’æ‰èƒ½æ‰“å¼€ç½‘é¡µï¼Œå¯¹ç”¨æˆ·ä¸å‹å¥½ï¼Œä½†æ˜¯æˆ‘ç°åœ¨ä¸çŸ¥é“å“ªä¸ªæœ€è€—æ—¶ï¼Œå¦‚ä½•æŠŠæœ€è€—æ—¶çš„æŸ¥è¯¢æ“ä½œæ‰¾å‡ºæ¥ï¼Ÿ</p>
<p>2ã€å¯¹äºæ¯æ¬¡è¿”å›15æ¡æ•°æ®ï¼Œæˆ‘ç”¨äº†ä¸¤ç§æ–¹å¼æ¥å†™ï¼Œä¸€ç§æ˜¯[start:end]åˆ‡ç‰‡limitæŸ¥è¯¢,ä¸€ç§æ˜¯ä»range(start,end)éå†15æ¬¡ï¼Œæ¯æ¬¡éƒ½æ˜¯æ ¹æ®ç´¢å¼•è¿›è¡ŒæƒŸä¸€æŸ¥è¯¢ï¼Œæ¯”è¾ƒè¿™ä¸¤ç§æŸ¥è¯¢è°æ›´å¿«ï¼Ÿ</p>
<p>å¥½äº†ï¼ŒSQLæ‰§è¡Œæ—¶é—´å¯ä»¥åœ¨Navicateä¸­è¿›è¡ŒæŸ¥çœ‹ï¼Œä¸è¿‡æˆ‘è¿™é‡Œè¦è·å–çš„æ˜¯ormæŸ¥è¯¢çš„æ‰§è¡Œæ—¶é—´ï¼Œå¯ä»¥è‡ªå·±åœ¨æŸ¥è¯¢æ‰§è¡Œå‰å’Œæ‰§è¡Œåè·å–æ—¶é—´ç›¸å‡è®¡ç®—æ‰§è¡Œæ—¶é—´ï¼Œä¸è¿‡è‡ªå·±è®¡ç®—ä¹Ÿæ¯”è¾ƒéº»çƒ¦äº†ï¼Œè¿™æœ€è¿‘çœ‹ç›¸å…³æŠ€æœ¯æ–‡ç« å‘ç°ï¼Œdjangoæä¾›äº†ä¸€ä¸ªèƒ½è¿”å›ormæŸ¥è¯¢æ—¶é—´çš„apiï¼Œæˆ‘ä»¬è°ƒç”¨å¯ä»¥ç›´æ¥æŸ¥çœ‹æ¯æ¬¡æŸ¥è¯¢çš„è€—æ—¶,å¦‚ä¸‹æ–¹ä»£ç æ‰€ç¤º<br>
from django.db import connection<br>
connection.queries</p>
<pre><code>`from django.db import connection
if stype=='b_other':
  counts = ArticleMmOther.objects.all().count()
  arts = ArticleMmOther.objects.values(&quot;id&quot;,&quot;title&quot;)[start:end]
  print(connection.queries)
  # arts = [ArticleMmOther.objects.values(&quot;id&quot;,&quot;title&quot;).get(id=i) for i in range(start, end)]
  title = a
  print(arts,type(arts))
  paginator = Paginator(range(counts), 15)`
</code></pre>
<p>ä¸‹æ–¹æ˜¯æ‰“å°çš„æŸ¥è¯¢æŠ¥å‘Šï¼š<br>
éªŒè¯ä¸€ï¼š<br>
countæŸ¥è¯¢ï¼š11.340s<br>
åˆ‡ç‰‡limitæŸ¥è¯¢ï¼š0.009s</p>
<pre><code>`[{'sql': 'SELECT @@SQL_AUTO_IS_NULL', 'time': '0.000'},
{'sql': 'SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED',
'time': '0.000'},

# countæŸ¥è¯¢æ€»æ•°é‡ï¼ŒæŸ¥è¯¢æ—¶é—´11.340s
{'sql': 'SELECT COUNT(*) AS `__count`
FROM `articlemmother`', 'time': '11.340'},

# limitæŸ¥è¯¢15æ¡æ•°æ®ï¼ŒæŸ¥è¯¢æ—¶é—´0.009s
{'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title`
FROM `articlemmother` ORDER BY `articlemmother`.`like` DESC,
`articlemmother`.`read` DESC LIMIT 15 OFFSET 2',
'time': '0.009'}]`
</code></pre>
<p>éªŒè¯äºŒï¼š<br>
countæŸ¥è¯¢ï¼š0.030s<br>
æƒŸä¸€ç´¢å¼•idæŸ¥è¯¢ï¼š0.000s</p>
<pre><code>`[{'time': '0.000', 'sql': 'SELECT @@SQL_AUTO_IS_NULL'}, {'time': '0.000', 'sql': 'SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED'},

# countæŸ¥è¯¢ç”¨æ—¶0.030s
{'time': '0.030', 'sql': 'SELECT COUNT(*) AS `__count` 
FROM `articlemmother`'},
# 15æ¡æ•°æ®å…¨éƒ¨é€šè¿‡æƒŸä¸€ç´¢å¼•idæŸ¥è¯¢,æ¯æ¡æ•°æ®éƒ½æ˜¯0.000s
{'time': '0.000', 'sql': 'SELECT VERSION()'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 1'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 2'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 3'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 4'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 5'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 6'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 7'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 8'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 9'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 10'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 11'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 12'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 13'},
{'time': '0.000', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 14'},
{'time': '0.001', 'sql': 'SELECT `articlemmother`.`id`, `articlemmother`.`title` FROM `articlemmother` WHERE `articlemmother`.`id` = 15'}]
[
</code></pre>
<p>æ¯”è¾ƒåˆ†æä¸ç»“è®ºï¼š<br>
1ã€éªŒè¯ä¸€ countæŸ¥è¯¢ 11.340ç§’ï¼ŒéªŒè¯äºŒcountæŸ¥è¯¢è€—æ—¶0.030ç§’ï¼Œæ˜æ˜¾æ˜¯è€—æ—¶æœ€é•¿çš„æŸ¥è¯¢ï¼Œå…¶å®ä¹Ÿä¸éš¾ç†è§£ï¼Œ100ä¸‡æ¡æ•°æ®æŸ¥èµ·æ¥ï¼Œå³ä½¿åªæŸ¥äº†æ•°é‡ï¼Œä¹Ÿç¡®å®èƒ½æ˜æ˜¾æ„ŸçŸ¥åˆ°æœ‰ç‚¹æ…¢ï¼Œå¯¹äºcountæŸ¥è¯¢ï¼Œç¬¬ä¸€æ¬¡11.340ç§’ï¼Œç¬¬äºŒæ¬¡0.030ç§’ï¼ŒåŸå› åº”è¯¥æ˜¯djangoæŸ¥è¯¢çš„ç¼“å­˜ä½œç”¨ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡æŸ¥çš„æ—¶å€™å°±å¿«äº†å¾ˆå¤šï¼Œéšç€ç¼“å­˜è¢«æ¸…é™¤ï¼Œå†å»åˆ·æ–°é¡µé¢è¿˜æ˜¯æœ‰å¾ˆé•¿çš„ç­‰å¾…æ—¶é—´ï¼Œé‚£ä¹ˆæ—¢ç„¶è¿™é‡ŒcountæŸ¥è¯¢å¾ˆè€—æ—¶ï¼Œé‚£æˆ‘å¹²è„†å°±ç»™ä¸€ä¸ªå›ºå®šå€¼ï¼Œ1000000ï¼Œåæ­£æ•°æ®é‡ä¹Ÿæ˜¯å›ºå®šçš„ï¼Œæˆ‘ç›´æ¥çœ‹ä¸‹æœ‰å¤šå°‘å°±è¡Œäº†ï¼Œçœçš„å†å»æŸ¥äº†ï¼Œå®Œç¾è§£å†³é¡µé¢å“åº”æ…¢çš„é—®é¢˜ï¼Œæ‰€æœ‰é¡µé¢ç›®å‰å·²ä¼˜åŒ–ç»Ÿç»Ÿç§’å¼€</p>
<p>2ã€éªŒè¯ä¸€çš„åˆ‡ç‰‡limitæŸ¥è¯¢15æ¡æ•°æ®ï¼š0.009sï¼ŒéªŒè¯äºŒçš„éå†15æ¬¡æƒŸä¸€ç´¢å¼•æŸ¥è¯¢ï¼Œæ¯ä¸ªéƒ½æ˜¯0.000sï¼Œå‡ ä¹ä¸è€—æ—¶ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼Œè¿˜æ˜¯é€šè¿‡idçš„æƒŸä¸€ç´¢å¼•å»æŸ¥æ›´å¿«äº›ï¼Œä½†ä¹Ÿä¸æ’é™¤15æ¡æ•°æ®éƒ½é€šè¿‡idå»æŸ¥çš„æ—¶é—´ä¹‹å’Œä¼šä¸ä¼šè¢«å››èˆäº”å…¥åè·ŸlimitæŸ¥è¯¢ç›¸å·®ä¸å¤š</p>
<p>æ€»ä½“æ¥è¯´ï¼Œé€šè¿‡ä¸Šé¢æ‰€è¯´çš„æ–¹æ³•ï¼Œåœ¨djangoæ€§èƒ½ä¼˜åŒ–æ—¶å€™ï¼Œå¯¹æ¯ä¸ªæŸ¥è¯¢çš„æ‰§è¡Œæ—¶é—´æœ‰ä¸ªæŠŠæ¡ï¼Œå°±èƒ½æ›´æœ‰é’ˆå¯¹æ€§çš„ä¼˜åŒ–ï¼Œè€Œä¸æ˜¯å»ç›²ç›®çŒœæµ‹æ€ä¹ˆä¼˜åŒ–</p>
 </p>
                      </div>
                  </div>

                  <div class="row">
                      <div class="col-md-12 animate-box">
                          
                              <div class="next-post">
                                  <div class="next">ä¸‹ä¸€ç¯‡</div>
                                  <a href="https://yooinn.github.io//post/pythontu-pian-pi-liang-ya-suo">
                                      <h3 class="post-title">
                                          [Python]å›¾ç‰‡æ‰¹é‡å‹ç¼©
                                      </h3>
                                  </a>
                              </div>
                          
                      </div>
                  </div>

                  <div class="row">
                      <div class="col-md-12 animate-box">
                          
                              
                                  <div id="gitalk-container"></div>
                              

                              
                          
                      </div>
                  </div>
              </div>

          </article>
      </div>
  </div>

    
<footer id="fh5co-footer">
  <p>Powered by <a href="https://yooinn.github.io/" target="_blank">Jiank</a></p>
</footer>


    
<!-- jQuery -->
<script src="https://yooinn.github.io//media/scripts/vendors/jquery.min.js"></script>
<!-- jQuery Easing -->
<script src="https://yooinn.github.io//media/scripts/vendors/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="https://yooinn.github.io//media/scripts/vendors/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="https://yooinn.github.io//media/scripts/vendors/jquery.waypoints.min.js"></script>
<!-- Main JS -->
<script src="https://yooinn.github.io//media/scripts/vendors/main.js"></script>
<!-- Md5 Min JS -->
<script src="https://yooinn.github.io//media/scripts/vendors/md5.min.js"></script>

<script type="application/javascript">
    hljs.initHighlightingOnLoad();
</script>



    
        <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
        <script>

            var gitalk = new Gitalk({
                clientID: '18da3e757583aa6301c0',
                clientSecret: '49cea6508bf61d7606bce51766288ea312bd7456',
                repo: 'yooinn.github.io',
                owner: 'yooinn',
                admin: ['yooinn'],
                id: md5(location.pathname),      // Ensure uniqueness and length less than 50
                distractionFreeMode: false  // Facebook-like distraction free mode
            })

            gitalk.render('gitalk-container')

        </script>
    

    




  </body>
</html>
